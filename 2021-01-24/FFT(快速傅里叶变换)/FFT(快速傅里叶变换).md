## FFT(快速傅里叶变换)

### 一、数学基础

- 单位根的性质

  - 极坐标下复数的乘法可以看成是实部为模长相乘，虚部为角度相加

    a+bi=(r1,θ1 )   c+di=(r2,θ2 )  z=re^iθ

     (r1,θ1 )* (r2,θ2 )=(r1* r2,θ1+θ2 )

  - ω^n=1的n个根为单位根

    ω_n^k=cos⁡〖2kπ/n〗+i sin⁡〖2kπ/n〗（k=0,1,….,n-1）

  - 消去引理

    ω_dn^dk=ω_n^k

  - 折半引理:如果n>0为偶数，那么n个n次单位复数根的平方的集合就是n/2个n/2次单位复数根的集合

      (ω_n^(k+n/2) )^2=(-ω_n^k )^2=ω_(n/2)^k 

- 多项式的系数表示法转换为点值表示法

  - 系数表示法：y=a_(n-1) x^(n-1)+a_(n-2) x^(n-2)+⋯a_0 

    可令  a ⃗=(a_(n-1),a_(n-2)⋯a_0 )

  - 点值表示法：n个方程可以解出n个未知数

    (x(n-1),y(n-1) )(x(n-2),y(n-2) )⋯(x0, y0 )

  - 离散傅里叶变换（DFT）,时间复杂度O(n^2 )

  - **快速傅里叶变换（FFT）**， 时间复杂度O(n log⁡n ) 

    ​       FFT可以通过单位根的性质，奇偶变化，将n次求值的时间复杂度降为 O(n log⁡n )

    A(x)→a ⃗=(a_(n-1),a_(n-2)⋯a_0 )  提取系数中的奇偶项可得

    a ⃗_([0])= (a_0,a_2,a_4,…,a_(n-2) ) → A^[0] (x)

    a ⃗_([1])= 〖(a〗_1,a_3,a_5…,a_(n-1) )→ A^[1]  (x)

    

    A(x)=a_(n-1) x^(n-1)+a_(n-2) x^(n-2)+⋯a_0

    A^[0] (x)= a_0+a_2 x+…+a_(n-2) x^(n/2-1)

    A^[1]  (x)= a_1+a_3 x+…+a_(n-1) x^(n/2-1)

    由观察可得A(x)=A^[0]  (x^2 )+xA^[1]  (x^2 )

    

    那么就将求次数界为n的值转化为求两个次数界为n/2的值，然后再相加

    

    设k<n/2，把ω_n^k作为x代入A(x)

    ​    A(ω_n^k)=A^([0])(ω_n^2k)+ ω_n^k A^([1])(ω_n^2k)

    ​       =A^([0])(ω_(n/2)^k)+ ω_n^k A^([1])(ω_(n/2)^k)

    对于A(ω_n^(k+n/2))，代入得

    ​    A(ω_n^(k+n/2))=A^([0])(ω_n^(2k+n))+ ω_n^(k+n/2) A^([1])(ω_n^(2k+n))

    ​        =A^([0])(ω_n^2k ω_n^n)- ω_n^k A^([1])(ω_n^2k ω_n^n)

    ​        =A^([0])(ω_n^2k)- ω_n^k A^([1])(ω_n^2k)

    ​        =A^([0])(ω_(n/2)^k)- ω_n^k A^([1])(ω_(n/2)^k)

    由上面两个式子可以知道，如果已知A^([0])(ω_(n/2)^k)和 ω_n^k A^([1])(ω_(n/2)^k)的值，我们就可以同时知道

    A(ω_n^k)和A(ω_n^(k+n/2))的值，即只需要知道前面一半的序列，即可得出后面一半序列的答案

    

    此时，时间复杂度T(n)=2T(n/2)+O(n)=O(n log⁡n )

### 二、FFT的代码实现

 FFT(a,lim)

1.If lim==1 return

2.a_([0])= (a0,a2,a4,…,a(n-2) )

3.a_([1])= (a1,a3,a5…,a(n-1) )

4.FFT(a([0]),lim/2)

5.FFT(a([1]),lim/2)

6.ωn=e^(i 2π/n)=cos⁡〖2π/n〗+i sin⁡〖2π/n〗

7.ω=1

8.For k=0…1,2,n/2-1

9.a_k=a_k^[0] +ωa_k^[1] 

10.a_(k+n/2)= a_k^[0] -ωa_k^[1] 

11.ω=ωωn













